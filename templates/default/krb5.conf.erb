# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
<% unless @includedir.empty? %>
<% @includedir.each do |dir| %>
includedir <%= dir %>
<% end %>
<% end %>

<% if @logging %>
[logging]
<% @logging.each do |k, v| %>
 <%= k %> = <%= v %>
<% end %>
<% end %>

<% if @libdefaults %>
[libdefaults]
<% @libdefaults.each do |k, v| %>
 <% if k == 'default_realm' %>
  <% v = v.upcase %>
 <% end %>
 <%= k %> = <%= v %>
<% end %>
<% end %>

<% if @realms %>
[realms]
 <% unless @realms['default_realm_kdcs'].empty? -%>
 <%= @realms['default_realm'].upcase %> = {
  <% @realms['default_realm_kdcs'].each do |kdc_server| -%>
  kdc = <%= kdc_server %>
  <% end -%>
  <% unless @realms['default_realm_admin_server'].nil? || @realms['default_realm_admin_server'].empty? -%>
  admin_server = <%= @realms['default_realm_admin_server'] %>
  <% end %>
 }
 <% end -%>

 <% if @realms['realms'].kind_of?(Array) -%>
  <% @realms['realms'].each do |krb5_realm| -%>
 <%= krb5_realm.downcase -%> = <%= krb5_realm.upcase %>
 .<%= krb5_realm.downcase -%> = <%= krb5_realm.upcase %>
  <% end -%>
 <% else -%>
  <% @realms['realms'].each do |realm, dns| -%>
    <% [*dns].each do |d| -%>
 <%= d.downcase -%> = <%= realm.upcase %>
 .<%= d.downcase -%> = <%= realm.upcase %>
     <% end -%>
   <% end -%>
  <% end %>
<% end %>

<% if @appdefaults %>
[appdefaults]
<% @appdefaults.each do |app, h| %>
 <%= app %> = {
  <% h.each do |k, v| %>
   <%= k %> = <%= v %>
  <% end %>
 }
<% end %>
<% end %>
